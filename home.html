<!DOCTYPE html>
<html data-bs-theme="light" lang="en" style="background: #171f39;">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>one</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="/assets/css/ABeeZee.css?h=c54efe6b252f9969e1b3d6e246bcdc7c">
    <link rel="stylesheet" href="/assets/css/Aclonica.css?h=97b1e26ff00c4959d0a130b0eb7e7f79">
    <link rel="stylesheet" href="/assets/css/ADLaM%20Display.css?h=ad7ee3830a3d458b41538812e33fac02">
    <link rel="stylesheet" href="/assets/css/Agbalumo.css?h=499695abc466939d36755e530011015f">
    <link rel="stylesheet" href="/assets/css/Bootstrap-Calendar.css?h=25a4143cdb7bc09ae8bd665f3ad1f911">
    <link rel="stylesheet" href="/assets/css/CanitoFormularioCompra2.css?h=99af41d95d8b0a00261b498825155ac5">
    <link rel="stylesheet" href="/assets/css/Easy-Contact-Form.css?h=88d6f09decefaba4ff1d58c3ec9a62d6">
    <link rel="stylesheet" href="/assets/css/Navbar-Right-Links-icons.css?h=befd8a398792e305b7ffd4a176b5b585">
    <link rel="stylesheet" href="/assets/css/Pretty-Registration-Form-.css?h=74cbd162836abb1eda12ebcad200c88a">
    <link rel="stylesheet" href="/assets/css/Profile-Edit-Form-styles.css?h=941c84e96020d5a5b03f80619fed6ea9">
    <link rel="stylesheet" href="/assets/css/Profile-Edit-Form.css?h=5ecb76a1061fdd34dcc451bc4075f02d">
</head>

<body style="height: 391px;background: #171f39;">
    <!-- Start: Navbar Right Links -->
    <nav class="navbar navbar-expand-md bg-body py-3" style="height: 107px;background: #171f39;">
        <div class="container"><a class="navbar-brand d-flex align-items-center" href="#"><span><img src="/assets/img/logo.png?h=715e274e9aeb51125d08eb27e5122285" style="width: 90px;height: 90px;" width="100" height="100"></span></a><button data-bs-toggle="collapse" class="navbar-toggler" data-bs-target="#navcol-1"><span class="visually-hidden">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navcol-1">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link active" href="/home.html" style="font-family: ABeeZee, sans-serif;font-size: 18px;color: #e2bf49;">Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="/community.html" style="font-family: ABeeZee, sans-serif;font-size: 18px;color: rgb(0,0,0);">Community</a></li>
                    <li class="nav-item"><a class="nav-link active" href="/profile.html" style="font-family: ABeeZee, sans-serif;font-size: 18px;color: rgb(0,0,0);">Profile</a></li>
                </ul>
            </div>
            <a href="login.html"><button class="btn btn-primary" type="button" style="background: #ffdd68;border-color: #ffdd68;">Sign Out</button></a>
            
        </div>
    </nav><!-- End: Navbar Right Links -->
    <!-- Start: 1 Row 2 Columns -->
    <div class="container">
        <div class="row" style="padding-top: 0px;margin-top: 40px;">
            <div class="col-md-6 col-xxl-3"><img src="/assets/img/Untitled_Artwork.png?h=431c58adfdf6f6257d3f76b25b93fa08" style="height: 300px;"></div>
            <div class="col-md-6 col-xxl-8">
                <p style="color: rgb(255,255,255);font-size: 64px;font-family: ABeeZee, sans-serif;" id="welcomeMessage">Welcome back, <span id="user-fname">name</span>!</p>
                <p style="color: rgb(255,255,255);font-size: 25px;font-family: ABeeZee, sans-serif;" id="currentGoal">Current Goal:&nbsp;</p>
                <p style="color: rgb(255,255,255);font-size: 25px;font-family: ABeeZee, sans-serif;" id="dailyStreak">Daily Streak:</p>
                <p style="color: rgb(255,255,255);font-size: 25px;font-family: ABeeZee, sans-serif;" id="timeSpent">Time Spent:</p>
            </div>
        </div>
    </div><!-- End: 1 Row 2 Columns -->
    <!-- Start: JLX Contact Form EN -->
    <div class="container">
        <!-- Start: Pretty Registration Form -->
        <div class="row register-form">
            <div class="col-md-8 offset-md-2">
                <form class="custom-form" style="font-family: ABeeZee, sans-serif;" id="registerForm" method="post">
                    <h1 style="border-color: #ffdd68;">Create a New Goal!</h1>
                    <div class="row form-group">
                        <div class="col-sm-4 label-column"><label class="col-form-label" for="name-input-field" style="font-weight: bold;">Goal (Try to be Specific)</label></div>
                        <div class="col-sm-6 input-column"><input class="form-control" type="text" id="title"></div>
                    </div>
                    <div class="row form-group">
                        <div class="col-sm-4 label-column"><label class="col-form-label" for="duration-input-field">Duration of Goal</label></div>
                        <div class="col-sm-6 input-column"><input class="form-control" type="text" id="description"></div>
                    </div>
                    <div class="row form-group">
                        <div class="col-sm-4 label-column"><label class="col-form-label" for="target-input-field">Target of Goal</label></div>
                        <div class="col-sm-6 input-column"><input class="form-control" type="text" id="target"></div>
                    </div>
                    <div class="row form-group">
                        <div class="col-sm-4 label-column"><label class="col-form-label" for="dropdown-input-field">Type of Goal</label></div>
                        <div class="col-sm-4 input-column">
                               <select name="goaltype" id=""goaltype><div class="dropdown-menu"><option class="dropdown-item">Concurrency</option><option class="dropdown-item">Time</option></div></select>
                        </div>
                    </div><button class="btn btn-light submit-button" type="goalsubmit" style="background: #ffdd68;">Submit Form</button>
                </form>
            </div>
        </div><!-- End: Pretty Registration Form -->
    </div><!-- End: JLX Contact Form EN -->
    <!-- Start: 1 Row 1 Column -->
    <div class="container">
        <div class="row">
            <div class="col-md-12"></div>
        </div>
    </div><!-- End: 1 Row 1 Column -->
    <p></p>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="/assets/js/bs-init.js?h=de3d39894fddf69026710ea6bd84d452"></script>
    <script src="https://geodata.solutions/includes/countrystate.js"></script>
    <script src="/assets/js/Profile-Edit-Form-profile.js?h=36f16d72db7b5e137e5f6f74a6f95a32"></script>
    <script>
        //script that loads user and goal data
        const loadUserProfile = async (username) => {
        try {
            const response = await fetch(`/user/${username}`);
            if (!response.ok) throw new Error('User not found');

            const user = await response.json();
        // Update the HTML with the user's first name and other details
            document.getElementById('welcomeMessage').innerText = `Welcome back, ${user.fname}!`;
            document.getElementById('currentGoal').innerText = user.currentGoal;
            document.getElementById('dailyStreak').innerText = user.dailyStreak;
            document.getElementById('timeSpent').innerText = user.timeSpent;
        } catch (error) {
            console.error(error);
            document.getElementById('welcomeMessage').innerText = 'Error loading user data';
        }
    };
    //script to add a new goal to the database    
        document.getElementById("goalForm").addEventListener('goalsubmit', async (event) => {
            event.preventDefault();
            try {
                const response = await fetch(`/goal`);
                if (!response.ok) throw new Error('Goal not found');

            const goal = await response.json();
                const title = document.getElementById('text').value;
                const description = document.getElementById('description').value;
                const target = document.getElementById('target').value;
                const goalType = document.getElementById('goalType').value;

                const response = await fetch("http://localhost:3000/", {
                    method: "POST",
                    headers: {
                        'Content-Type': "application/json"
                    },
                    body: JSON.stringify({ title, description, goalType, target })
                });

                const data = await add.json();

                if (add.ok) {
                    alert(data.message);
                    window.location.href = "/home.html";

                } else {
                    alert("Goal Addition Failed: ${data.message}");
                }

            } catch (error) {
                console.error("Error registering:", error);
                alert("Error occurred while adding goal, try again.");
            }
        });
    </script>
</body>

</html>